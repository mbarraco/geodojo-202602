unit:
  number: 3
  title: Pandas para Datos Geográficos
  description: Guía para la clase sobre lectura y manipulación de datos con Pandas.
temario:
- title: Cargar datos y exploración básica
  rows:
  - - '`pd.read_csv(path)`'
    - Lee archivo CSV
    - '`df = pd.read_csv("datos.csv")`'
  - - '`df.head(n)`'
    - Primeras n filas
    - '`df.head(5)`'
  - - '`df.tail(n)`'
    - Últimas n filas
    - '`df.tail(3)`'
  - - '`df.shape`'
    - Dimensiones (filas, cols)
    - '`(100, 5)`'
  - - '`df.columns`'
    - Nombres de columnas
    - '`[''nombre'', ''lat'', ''lon'']`'
  - - '`df.dtypes`'
    - Tipos de datos
    - '`nombre: object, lat: float64`'
  - - '`df.describe()`'
    - Estadísticas básicas
    - Media, std, min, max, etc.
  columns:
  - Función
  - Descripción
  - Ejemplo
- title: Selección con loc e iloc
  rows:
  - - '`df["col"]`'
    - Selecciona columna
    - '`df["nombre"]`'
  - - '`df[["c1", "c2"]]`'
    - Múltiples columnas
    - '`df[["nombre", "lat"]]`'
  - - '`df.iloc[i]`'
    - Fila por posición
    - '`df.iloc[0]` → primera fila'
  - - '`df.iloc[i:j]`'
    - Rango de filas
    - '`df.iloc[0:5]`'
  - - '`df.iloc[i, j]`'
    - Celda específica
    - '`df.iloc[0, 2]`'
  - - '`df.loc[label]`'
    - Fila por etiqueta
    - '`df.loc["Buenos Aires"]`'
  - - '`df.loc[label, col]`'
    - Celda por etiqueta
    - '`df.loc["BA", "lat"]`'
  columns:
  - Método
  - Descripción
  - Ejemplo
- title: Filtrado de datos
  rows:
  - - Condición simple
    - '`df[df["col"] > x]`'
    - '`df[df["poblacion"] > 1000000]`'
  - - Múltiples condiciones
    - '`df[(cond1) & (cond2)]`'
    - '`df[(df["lat"] < -30) & (df["lon"] < -60)]`'
  - - OR lógico
    - '`df[(cond1) \'
    - (cond2)]`
    - '`df[(df["region"] == "N") \'
    - (df["region"] == "S")]`
  - - Método query
    - '`df.query("expr")`'
    - '`df.query("poblacion > 1000000")`'
  - - Está en lista
    - '`df[df["col"].isin(lista)]`'
    - '`df[df["nombre"].isin(["BA", "CB"])]`'
  - - String contiene
    - '`df[df["col"].str.contains("x")]`'
    - '`df[df["nombre"].str.contains("Aires")]`'
  columns:
  - Operación
  - Sintaxis
  - Ejemplo
- title: Agrupación y agregación
  rows:
  - - Agrupar
    - '`df.groupby("col")`'
    - Objeto GroupBy
  - - Contar
    - '`grouped.size()`'
    - Serie con conteos
  - - Sumar
    - '`grouped["col"].sum()`'
    - Serie con sumas
  - - Promedio
    - '`grouped["col"].mean()`'
    - Serie con promedios
  - - Múltiples
    - '`grouped.agg(["sum", "mean"])`'
    - DataFrame
  - - Agg personalizado
    - '`grouped.agg({"col1": "sum", "col2": "mean"})`'
    - DataFrame
  columns:
  - Operación
  - Sintaxis
  - Resultado
- title: Guardar y combinar DataFrames
  rows:
  - - Guardar CSV
    - '`df.to_csv(path, index=False)`'
    - Exportar datos
  - - Ordenar
    - '`df.sort_values("col")`'
    - Ordenar por columna
  - - Concatenar
    - '`pd.concat([df1, df2])`'
    - Unir filas
  - - Merge
    - '`pd.merge(df1, df2, on="col")`'
    - JOIN por columna
  - - Nueva columna
    - '`df["nueva"] = valor`'
    - Agregar columna
  - - Columna calculada
    - '`df["c"] = df["a"] + df["b"]`'
    - Operaciones
  columns:
  - Operación
  - Sintaxis
  - Uso
ejemplos:
- id: 1
  title: Leer CSV con pandas
  enunciado: Leer un archivo CSV de ciudades argentinas y mostrar el DataFrame.
  solucion:
    code: |-
      import pandas as pd

      # Crear CSV de ejemplo
      datos = """nombre,latitud,longitud,poblacion,region
      Buenos Aires,-34.6,-58.4,2890000,Pampeana
      Córdoba,-31.4,-64.2,1430000,Pampeana
      Rosario,-33.0,-60.7,1270000,Pampeana
      Mendoza,-32.9,-68.8,115000,Cuyo
      Salta,-24.8,-65.4,620000,Norte"""

      with open("ciudades.csv", "w") as f:
          f.write(datos)

      # Leer con pandas
      df = pd.read_csv("ciudades.csv")
      print(df)
    salida: |2-
               nombre  latitud  longitud  poblacion    region
      0  Buenos Aires    -34.6     -58.4    2890000  Pampeana
      1       Córdoba    -31.4     -64.2    1430000  Pampeana
      2       Rosario    -33.0     -60.7    1270000  Pampeana
      3       Mendoza    -32.9     -68.8     115000      Cuyo
      4         Salta    -24.8     -65.4     620000     Norte
- id: 2
  title: Explorar el DataFrame
  enunciado: Ver las primeras filas, la forma, las columnas y las estadísticas básicas.
  solucion:
    code: |-
      print("Primeras 3 filas:")
      print(df.head(3))

      print(f"\nForma: {df.shape}")
      print(f"Columnas: {list(df.columns)}")

      print("\nEstadísticas:")
      print(df.describe())
    salida: |-
      Primeras 3 filas:
               nombre  latitud  longitud  poblacion    region
      0  Buenos Aires    -34.6     -58.4    2890000  Pampeana
      1       Córdoba    -31.4     -64.2    1430000  Pampeana
      2       Rosario    -33.0     -60.7    1270000  Pampeana

      Forma: (5, 5)
      Columnas: ['nombre', 'latitud', 'longitud', 'poblacion', 'region']

      Estadísticas:
               latitud   longitud      poblacion
      count   5.000000   5.000000   5.000000e+00
      mean  -31.340000 -63.500000   1.265000e+06
      ...
- id: 3
  title: Seleccionar columnas
  enunciado: Crear un nuevo DataFrame con solo nombre y población.
  solucion:
    code: |-
      # Una columna (Serie)
      nombres = df["nombre"]
      print("Columna nombre:")
      print(nombres)

      # Múltiples columnas (DataFrame)
      df_reducido = df[["nombre", "poblacion"]]
      print("\nNombre y población:")
      print(df_reducido)
    salida: |-
      Columna nombre:
      0    Buenos Aires
      1         Córdoba
      2         Rosario
      3         Mendoza
      4           Salta
      Name: nombre, dtype: object

      Nombre y población:
               nombre  poblacion
      0  Buenos Aires    2890000
      1       Córdoba    1430000
      2       Rosario    1270000
      3       Mendoza     115000
      4         Salta     620000
- id: 4
  title: Acceder a filas con iloc
  enunciado: Obtener la primera ciudad, las primeras 3, y una celda específica.
  solucion:
    code: |-
      # Primera fila (Serie)
      print("Primera ciudad:")
      print(df.iloc[0])

      # Primeras 3 filas (DataFrame)
      print("\nPrimeras 3 ciudades:")
      print(df.iloc[0:3])

      # Celda específica: fila 0, columna 3 (población)
      poblacion_ba = df.iloc[0, 3]
      print(f"\nPoblación de Buenos Aires: {poblacion_ba}")
    salida: |-
      Primera ciudad:
      nombre       Buenos Aires
      latitud             -34.6
      longitud            -58.4
      poblacion         2890000
      region           Pampeana
      Name: 0, dtype: object

      Primeras 3 ciudades:
               nombre  latitud  longitud  poblacion    region
      0  Buenos Aires    -34.6     -58.4    2890000  Pampeana
      1       Córdoba    -31.4     -64.2    1430000  Pampeana
      2       Rosario    -33.0     -60.7    1270000  Pampeana

      Población de Buenos Aires: 2890000
- id: 5
  title: Filtrar por condición
  enunciado: Mostrar solo ciudades con más de 1 millón de habitantes.
  solucion:
    code: |-
      # Crear máscara booleana
      mascara = df["poblacion"] > 1000000
      print("Máscara:")
      print(mascara)

      # Aplicar filtro
      grandes = df[df["poblacion"] > 1000000]
      print("\nCiudades con más de 1M habitantes:")
      print(grandes)
    salida: |-
      Máscara:
      0     True
      1     True
      2     True
      3    False
      4    False
      Name: poblacion, dtype: bool

      Ciudades con más de 1M habitantes:
               nombre  latitud  longitud  poblacion    region
      0  Buenos Aires    -34.6     -58.4    2890000  Pampeana
      1       Córdoba    -31.4     -64.2    1430000  Pampeana
      2       Rosario    -33.0     -60.7    1270000  Pampeana
- id: 6
  title: Filtrar con múltiples condiciones
  enunciado: Ciudades del hemisferio sur (lat < 0) con longitud oeste de -60.
  solucion:
    code: |-
      # Ambas condiciones deben cumplirse
      filtro = df[(df["latitud"] < 0) & (df["longitud"] < -60)]

      print("Ciudades al sur y oeste de -60:")
      print(filtro[["nombre", "latitud", "longitud"]])
    salida: |-
      Ciudades al sur y oeste de -60:
          nombre  latitud  longitud
      1  Córdoba    -31.4     -64.2
      2  Rosario    -33.0     -60.7
      3  Mendoza    -32.9     -68.8
      4    Salta    -24.8     -65.4
- id: 7
  title: Agregar columna calculada
  enunciado: Crear una columna "hemisferio" basada en la latitud.
  solucion:
    code: |-
      # Usando apply con función lambda
      df["hemisferio"] = df["latitud"].apply(
          lambda x: "Sur" if x < 0 else "Norte"
      )

      print(df[["nombre", "latitud", "hemisferio"]])
    salida: |2-
               nombre  latitud hemisferio
      0  Buenos Aires    -34.6        Sur
      1       Córdoba    -31.4        Sur
      2       Rosario    -33.0        Sur
      3       Mendoza    -32.9        Sur
      4         Salta    -24.8        Sur
- id: 8
  title: Agrupar y agregar
  enunciado: Contar ciudades por región y calcular población total por región.
  solucion:
    code: |-
      # Contar por región
      conteo = df.groupby("region").size()
      print("Ciudades por región:")
      print(conteo)

      # Población total por región
      poblacion_region = df.groupby("region")["poblacion"].sum()
      print("\nPoblación por región:")
      print(poblacion_region)

      # Múltiples estadísticas
      stats = df.groupby("region")["poblacion"].agg(["count", "sum", "mean"])
      print("\nEstadísticas por región:")
      print(stats)
    salida: "Ciudades por región:\nregion\nCuyo        1\nNorte       1\nPampeana    3\ndtype: int64\n\nPoblación por región:\n\
      region\nCuyo         115000\nNorte        620000\nPampeana    5590000\nName: poblacion, dtype: int64\n\nEstadísticas\
      \ por región:\n          count      sum          mean\nregion                                \nCuyo          1   115000\
      \  115000.000000\nNorte         1   620000  620000.000000\nPampeana      3  5590000 1863333.333333"
- id: 9
  title: Ordenar y guardar
  enunciado: Ordenar por población descendente y guardar en nuevo CSV.
  solucion:
    code: |-
      # Ordenar de mayor a menor población
      df_ordenado = df.sort_values("poblacion", ascending=False)
      print("Ordenado por población:")
      print(df_ordenado[["nombre", "poblacion"]])

      # Guardar a CSV (sin índice)
      df_ordenado.to_csv("ciudades_ordenadas.csv", index=False)
      print("\nArchivo guardado!")
    salida: |-
      Ordenado por población:
               nombre  poblacion
      0  Buenos Aires    2890000
      1       Córdoba    1430000
      2       Rosario    1270000
      4         Salta     620000
      3       Mendoza     115000

      Archivo guardado!
- id: 10
  title: Combinar DataFrames
  enunciado: Hacer merge de datos de ciudades con datos de clima.
  solucion:
    code: "# Crear DataFrame de clima\nclima = pd.DataFrame({\n    \"ciudad\": [\"Buenos Aires\", \"Córdoba\", \"Mendoza\"\
      ],\n    \"temp_media\": [18.5, 17.2, 16.8],\n    \"precipitacion\": [1200, 800, 200]\n})\n\n# Merge por nombre de ciudad\n\
      df_completo = pd.merge(\n    df, \n    clima, \n    left_on=\"nombre\", \n    right_on=\"ciudad\"\n)\n\nprint(\"Datos\
      \ combinados:\")\nprint(df_completo[[\"nombre\", \"poblacion\", \"temp_media\", \"precipitacion\"]])"
    salida: |-
      Datos combinados:
               nombre  poblacion  temp_media  precipitacion
      0  Buenos Aires    2890000        18.5           1200
      1       Córdoba    1430000        17.2            800
      2       Mendoza     115000        16.8            200
notas_docente:
- Los ejemplos están diseñados para hacerse en vivo, escribiendo el código desde cero
- Crear el CSV inicial es importante para que todos trabajen con los mismos datos
- Enfatizar la diferencia entre `iloc` (posición) y `loc` (etiqueta)
- El filtrado con múltiples condiciones requiere paréntesis y operadores `&` / `|`
- '`groupby` es muy poderoso - dedicarle tiempo suficiente'
- Los ejercicios en `ejercicios/03/03-pandas.md` refuerzan estos conceptos
- 'Contexto geográfico: ciudades argentinas, coordenadas, regiones, población'
